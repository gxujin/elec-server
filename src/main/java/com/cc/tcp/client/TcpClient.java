package com.cc.tcp.client;

import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.net.Socket;

public class TcpClient {

	private Socket socket;

	public TcpClient(String serverIp, String serverPort){
		try {
			this.socket = new Socket(serverIp, Integer.parseInt(serverPort));
			System.out.println("服务连接成功");
		} catch (Exception e) {
			System.out.println("服务器连接失败");
			e.printStackTrace();
		}
	}

	public void close(){
		try {
			this.socket.close();
			System.out.println("断开服务器连接");
		} catch (IOException e) {
			System.out.println("断开服务器连接失败");
		}
	}

	/**
	 * 写消息
	 * @param bytemsg
	 * @throws Exception
	 */
	public byte[] write(byte[] bytemsg, String charset)throws Exception{
		OutputStream os = null;
		InputStream is = null;
		byte[] result = null;
		try{
			//写
			os = socket.getOutputStream();
			os.write(bytemsg);
			os.flush();
			System.out.println("request msg:" + new String(bytemsg, charset));

			//读
			is = socket.getInputStream();// 读取数据是阻塞式的
			byte[] body = new byte[1024];
			int len = is.read(body);

			byte[] bytes = new byte[len];
			for(int i=0;i<len;i++){
				bytes[i]=body[i];
			}
			String resultStr = new String(bytes, charset);
			System.out.println("response msg:" + resultStr);

		}catch(Exception e){
			e.printStackTrace();
		}finally{
//			if(is!=null) is.close();
//			if(os!=null) os.close();
//			if(socket!=null) socket.close();
		}

		return result;
	}

	public static void main(String args[]) throws Exception {
		String host = "127.0.0.1";
		String port = "9988";
		String msg = "00242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc8";
		msg = "04097|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fWO400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fWOSHI";
		msg = "08190|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fWO400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fWOSHI400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fWO400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fc099d62cd3cab8687ab1b07216bc5074b60ea4d7e866fbe26295c7b335714e7c10bea3923f5939077f350f8f52b5aa2196c883aec1f73f8cf524ab2391636eabc800242|400014|c001|1cb30c7e1edb1c2f4f44198c3e7cc905d944de3b479a7b41710d3a7db1bb17b7e88669cab214ed009acc6c25b7741fWOSHI99";
		TcpClient client = new TcpClient(host, port);
		for(int i=0;i<1;i++){
			client.write(msg.getBytes(), "UTF-8");
//			new Thread(()->{
//				try{
//				}catch (Exception e){
//				}
//			}).start();
		}
//		client.close();
//		Thread.sleep(30000);
	}
}
